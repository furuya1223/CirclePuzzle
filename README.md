# CirclePuzzle
某有名オチモノパズルゲームの円柱版   

【機能】  
	円柱状のフィールドでオチモノパズルゲームを遊ぶことができます。  
	同じ段の一周全部をブロックで埋めるとその段が消えて、上のブロックが全て一段落ちます。  
	フィールドを円柱状にしているので、左右いくらでも動かせるようになっています。  
	
	向かい側は見えにくいので、マウスを用いて視点を変更しないといけません。  
	画面にはスコアとレベルが表示されています。  
	レベルはブロック出現時とライン消去時に増加します。  
	ただし、レベルが100の倍数になるとき（最後のみ999になるとき）はライン消去でしか増加しません。  
	レベルが10増加するごとにブロックの落下速度が微妙に上昇します。  
	ブロック出現ポイントにブロックが存在するとき、ゲームオーバーになります。  
	ゲームオーバーすると全てのブロックが赤くなり、標準出力にスコアとレベルが表示されます。  
	Tスピンは残念ながら実装していません。  
	
	フィールドの横・縦のサイズはHORIZONTAL, VERTICALとしてマクロ定義されているので、自由に変更できます。  
	HORIZONTAL（デフォルト12）を2にするの何も表示されないので最小は3です。  
	HORIZONTALを3にするともはやテトリスとは程遠い見た目ですが、それはそれで面白かったです。  
	VERTICALはデフォルト20ですが、8くらいまで下げても遊べます。その分難しくなります。  
	VERTICALを8以下にすると一度失敗したときにリカバリがほぼ不可能になります。それはそれで楽しいです。  
	
	【操作方法】  
		キーボードの矢印キー（下と左右）で、落ちてくるブロック（テトリミノ）を動かせます。  
		キーボードの上矢印キーで、落ちてくるブロックを瞬時に落下させることができます。  
		（上キーで落下させた場合、落とした段数分、スコアが加算されます。）  
		キーボードのXキーとZキーでブロックを回転させることができます。  
		マウスの左ドラッグでフィールドを回転させることができます。  
		SHIFTキーを押しながら左ドラッグで画面を平行移動できます。  
		CTRLキーを押しながら左ドラッグ（上下移動）でズームイン・ズームアウトできます。  
		マウスの右ドラッグで画面全体を平面回転させることができます。  
		

【実装】  
	【変数・データ構造】  
		vec2i：2次元整数ベクトルの構造体。マウスカーソルの移動量などに使用。  
		vec3f：3次元実数ベクトルの構造体。空間座標を表現するのに使用。  
		right_click = 0：右クリック時に立つフラグ。視点操作のタイプを判断。  
		motion_prev：直前のマウス位置を記録。視点変更に使用。  
		eye：視点座標  
		lookat：注視点座標  
		look：視線方向単位ベクトル  
		up：画面上方向単位ベクトル  
		look_dist：視点と注視点の距離  
		ctrl, shift：各種特殊キーの押下フラグ。視点操作のタイプを判断。  
		
		board[HORIZONTAL][VERTICAL + 2]：フィールド。サイズはマクロ定義。  
			横方向は見た目通りリングバッファとして扱っています。  
		current：現在落下中のテトリミノの状態を保持するグローバル変数  
		score, level：スコアとレベル  
		time_interval：timer関数を呼ぶ間隔。すなわち落下速度（の逆数）  
		game_over：ゲームオーバーフラグ。終了後のキー入力受付を防止  
		block[9]：各種ブロック（NULLと壁を含む）の情報を保存  
		block_color：各種ブロックの色を保存。  
		
	【関数】  
		多数かつ説明が難しいので、ソースコード内のコメントをご参照いただきたいです。  
